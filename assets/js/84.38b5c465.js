(window.webpackJsonp=window.webpackJsonp||[]).push([[84],{459:function(t,s,a){"use strict";a.r(s);var e=a(33),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"スクリプト表記"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#スクリプト表記"}},[t._v("#")]),t._v(" スクリプト表記")]),t._v(" "),a("p",[t._v("naninovelスクリプトを作成するときは、中かっこ "),a("code",[t._v("{}")]),t._v("を使用して、式の構成をコマンドパラメーター値と一般テキスト行に挿入できます:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("One plus two equals {1 + 2}.\n")])])]),a("p",[t._v('— スクリプトを実行すると、"One plus two equals 3" を表示します。')]),t._v(" "),a("p",[a("a",{attrs:{href:"https://docs.unity3d.com/ScriptReference/Mathf.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("UnityEngine.Mathf"),a("OutboundLink")],1),t._v("および"),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/dotnet/api/system.math#methods",target:"_blank",rel:"noopener noreferrer"}},[t._v("System.Math"),a("OutboundLink")],1),t._v(" ネームスペースの数学関数に加えて、数式、論理演算子が使えます:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("@char Kohaku scale:{Pow(Cosh(33.5), 3) % Log(0.5)}\n")])])]),a("p",[t._v('— これは IDが "Kohaku" のキャラクターを、33.5度の双曲線コサインを3乗し、自然対数0.5で割ったもので拡大します:')]),t._v(" "),a("p",[t._v("式はコマンドの実行時に評価され、式内で "),a("RouterLink",{attrs:{to:"/ja/guide/custom-variables.html"}},[t._v("カスタム変数")]),t._v(" を使用できます。")],1),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('@input color summary:"What\'s your favorite color?"\n@stop\n{color}, huh? { color == "orange" ? "Mine too!" : "I see..."}\n')])])]),a("p",[t._v("— 上記はプレイヤーに好きな色を入力させる入力UIを表示し、カスタム変数 "),a("code",[t._v("color")]),t._v(' に割り当てます。そして入力された色を表示し、もし "orange" なら "Mine too!" それ以外なら "I see..." と続けます。')]),t._v(" "),a("p",[t._v("プレーンテキスト値と変数名を区別するには、値を二重引用符 "),a("code",[t._v('"')]),t._v(" で囲みます:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('This is just a plain text: { "score" }.\nAnd this is the value of "score" variable: { score }.\n')])])]),a("p",[t._v("式に二重引用符を含める場合は、 "),a("strong",[t._v("2回")]),t._v(" エスケープします:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('Saying { \\\\"Stop the car\\\\" } was a mistake.\n')])])]),a("p",[a("a",{attrs:{href:"/api/#set",target:"_blank"}},[a("code",[t._v("@set")])]),t._v(" と "),a("a",{attrs:{href:"/api/#if",target:"_blank"}},[a("code",[t._v("@if")])]),t._v(" コマンド(他のコマンドの "),a("code",[t._v("set")]),t._v(" と "),a("code",[t._v("if")]),t._v(" パラメーターも同様)の中で使われる式は、中かっこは必要ありません:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("@set randomScore=Random(-100,100)\n@goto EpicLabel if:Abs(randomScore)>=50\n")])])]),a("p",[t._v("ただし、他のすべてのパラメーター値と同様に、式内でスペースを使用する場合は、二重引用符で囲む必要があります:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('@set "randomScore = Random(-100, 100)"\n@goto EpicLabel if:"Abs(randomScore) >= 50"\n')])])]),a("p",[t._v("一般テキスト内に中かっこを表示し、式の開始/終了リテラルとして認識されないようにするには、中かっこをバックスラッシュでエスケープします。例:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("Some text \\{ text inside braces \\}\n")])])]),a("p",[t._v('— 上記はゲーム内に "Some text { text inside braces }" と表示します。')]),t._v(" "),a("h2",{attrs:{id:"関数式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#関数式"}},[t._v("#")]),t._v(" 関数式")]),t._v(" "),a("p",[t._v("次の関数は、スクリプト式内でも使用できます。")]),t._v(" "),a("div",{staticClass:"config-table"},[a("table",[a("thead",[a("tr",[a("th",[t._v("Signature")]),t._v(" "),a("th",[t._v("説明")]),t._v(" "),a("th",[t._v("使用例")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Random ("),a("em",[t._v("System.Double")]),t._v(" min, "),a("em",[t._v("System.Double")]),t._v(" max)")]),t._v(" "),a("td",[t._v("最小[引数]と最大[引数]の間で、ランダムな浮動小数点の数値を返します。")]),t._v(" "),a("td",[a("code",[t._v("Random(0.1, 0.85)")])])]),t._v(" "),a("tr",[a("td",[t._v("Random ("),a("em",[t._v("System.Int32")]),t._v(" min, "),a("em",[t._v("System.Int32")]),t._v(" max)")]),t._v(" "),a("td",[t._v("最小[引数]と最大[引数]の間で、ランダムな整数を返します、")]),t._v(" "),a("td",[a("code",[t._v("Random(0, 100)")])])]),t._v(" "),a("tr",[a("td",[t._v("Random ("),a("em",[t._v("System.String[]")]),t._v(" args)")]),t._v(" "),a("td",[t._v("指定した文字列の中から1つを返します。")]),t._v(" "),a("td",[a("code",[t._v('Random("Foo", "Bar", "Foobar")')])])]),t._v(" "),a("tr",[a("td",[t._v("CalculateProgress ()")]),t._v(" "),a("td",[t._v("0.0から1.0の範囲の浮動小数点の数値を返します。Naninovel で使用可能な全てのスクリプトコマンドの合計に対して、これまでに実行したユニークなコマンド数を表します。1.0は、プレイヤーが全てのコンテンツを "),a("code",[t._v("読み通した")]),t._v(" か "),a("code",[t._v("見た")]),t._v(" ということになります。この機能を使う前に、スクリプトコンフィグメニューで必ず "),a("code",[t._v("Count Total Commands")]),t._v(" を有効にして下さい。")]),t._v(" "),a("td",[a("code",[t._v("CalculateProgress()")])])])])])]),t._v(" "),a("h2",{attrs:{id:"カスタム関数の追加"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#カスタム関数の追加"}},[t._v("#")]),t._v(" カスタム関数の追加")]),t._v(" "),a("p",[t._v("静的 C# クラスに "),a("code",[t._v("ExpressionFunctions")]),t._v(" 属性を割り当てることにより、カスタム式関数を追加できます。 互換性のあるシグネチャを持つこのクラスのすべてのパブリックメソッドは、スクリプト式で自動的に使用できるようになります。")]),t._v(" "),a("p",[t._v("互換性のあるシグネチャは、"),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/value-types#simple-types",target:"_blank",rel:"noopener noreferrer"}},[t._v("simple"),a("OutboundLink")],1),t._v(" 型と文字列型を受け取り、返します。"),a("code",[t._v("params")]),t._v(" キーワードが付いたこのタイプの配列も同様です。")]),t._v(" "),a("div",{staticClass:"language-csharp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-csharp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token attribute"}},[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Naninovel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExpressionFunctions")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CustomFunctions")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// すべての文字を小文字に変換して、指定した文字列を返します。")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")])]),t._v(" ToLower "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")])]),t._v(" content"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" content"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ToLower")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定した数値の合計を返します。")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")])]),t._v(" Add "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")])]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")])]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定した文字列の1つからランダムに選択された文字列を返します。")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")])]),t._v(" Random "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("params")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")])]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")])]),t._v(" randomIndex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" UnityEngine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("randomIndex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("div",{staticClass:"custom-block example"},[a("p",{staticClass:"custom-block-title"},[t._v("例")]),t._v(" "),a("p",[t._v("カスタム式関数を追加して、アイテムがインベントリに存在するかどうかを確認する別の例は "),a("a",{attrs:{href:"https://github.com/Elringus/NaninovelInventory",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHubのインベントリサンプルプロジェクト"),a("OutboundLink")],1),t._v(" にあります。。")]),t._v(" "),a("p",[t._v("具体的には、カスタム関数は "),a("a",{attrs:{href:"https://github.com/Elringus/NaninovelInventory/blob/master/Assets/NaninovelInventory/Runtime/InventoryFunctions.cs",target:"_blank",rel:"noopener noreferrer"}},[t._v("InventoryFunctions.cs"),a("OutboundLink")],1),t._v(" ランタイムスクリプトで実装されています。")])])])}),[],!1,null,null,null);s.default=n.exports}}]);