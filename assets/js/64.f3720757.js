(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{438:function(t,a,e){"use strict";e.r(a);var n=e(33),s=Object(n.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"カスタムコマンド"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#カスタムコマンド"}},[t._v("#")]),t._v(" カスタムコマンド")]),t._v(" "),e("p",[t._v("コマンドは、シーンで起きることを制御する単一の操作を表します。たとえば、背景の変更、キャラクターの移動、別のnaninovelスクリプトの読み込みに使用できます。"),e("RouterLink",{attrs:{to:"/ja/guide/naninovel-scripts.html"}},[t._v("Naninovel スクリプト")]),t._v(" で定義されたパラメーター化されたコマンドシーケンスは、ゲームフローを効果的に制御します。使用可能な組み込みコマンドは "),e("RouterLink",{attrs:{to:"/ja/api/"}},[t._v("APIリファレンス")]),t._v(" に記載されています。コードでは、すべての組み込みスクリプトコマンドの実装は、"),e("code",[t._v("Naninovel.Commands")]),t._v(" ネームスペース以下に定義されています。")],1),t._v(" "),e("p",[t._v("独自のカスタムスクリプトコマンドを追加するには、"),e("code",[t._v("Command")]),t._v(" から派生した新しい C# クラスを作成し、抽象メソッド "),e("code",[t._v("ExecuteAsync")]),t._v(" を実装します。作成されたクラスはエンジンによって自動的に取得され、クラス名またはエイリアス（割り当てられている場合）によってnaninovelスクリプトからコマンドを呼び出すことができます。 naninovelコマンドにエイリアスを割り当てるには、クラスに "),e("code",[t._v("CommandAlias")]),t._v(" 属性を適用します。")]),t._v(" "),e("p",[e("code",[t._v("ExecuteAsync")]),t._v(" はコマンドがスクリプトプレイヤーで実行される時に呼び出される非同期メソッドで、そこにコマンドロジックを配置します。エンジンの組み込みシステムへアクセスするには "),e("RouterLink",{attrs:{to:"/ja/guide/engine-services.html"}},[t._v("エンジンサービス")]),t._v(" を使用してください。Naninovelスクリプトの実行は、"),e("code",[t._v("Wait")]),t._v(" パラメータが "),e("code",[t._v("true")]),t._v(" の場合に、メソッドが完了したタスクを返すまで停止します。")],1),t._v(" "),e("p",[t._v("コマンドパラメータをnaninovelスクリプトに公開するには、サポートされているいずれかのタイプを使用して、コマンドクラスにパブリックフィールドを追加します:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("フィールドタイプ")]),t._v(" "),e("th",[t._v("値のタイプ")]),t._v(" "),e("th",[t._v("スクリプト例")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("StringParameter")]),t._v(" "),e("td",[t._v("String")]),t._v(" "),e("td",[e("code",[t._v("LoremIpsum")]),t._v(", "),e("code",[t._v('"Lorem ipsum"')])])]),t._v(" "),e("tr",[e("td",[t._v("IntegerParameter")]),t._v(" "),e("td",[t._v("Int32")]),t._v(" "),e("td",[e("code",[t._v("10")]),t._v(", "),e("code",[t._v("0")]),t._v(", "),e("code",[t._v("-1")])])]),t._v(" "),e("tr",[e("td",[t._v("DecimalParameter")]),t._v(" "),e("td",[t._v("Single")]),t._v(" "),e("td",[e("code",[t._v("0.525")]),t._v(", "),e("code",[t._v("-55.1")])])]),t._v(" "),e("tr",[e("td",[t._v("BooleanParameter")]),t._v(" "),e("td",[t._v("Boolean")]),t._v(" "),e("td",[e("code",[t._v("true")]),t._v(", "),e("code",[t._v("false")])])]),t._v(" "),e("tr",[e("td",[t._v("NamedStringParameter")]),t._v(" "),e("td",[t._v("NamedString")]),t._v(" "),e("td",[e("code",[t._v("Script001.LabelName")]),t._v(", "),e("code",[t._v(".LabelName")])])]),t._v(" "),e("tr",[e("td",[t._v("NamedIntegerParameter")]),t._v(" "),e("td",[t._v("NamedInteger")]),t._v(" "),e("td",[e("code",[t._v("Yuko.5")])])]),t._v(" "),e("tr",[e("td",[t._v("NamedDecimalParameter")]),t._v(" "),e("td",[t._v("NamedFloat")]),t._v(" "),e("td",[e("code",[t._v("Kohaku.-10.25")])])]),t._v(" "),e("tr",[e("td",[t._v("NamedBooleanParameter")]),t._v(" "),e("td",[t._v("NamedBoolean")]),t._v(" "),e("td",[e("code",[t._v("Misaki.false")])])]),t._v(" "),e("tr",[e("td",[t._v("StringListParameter")]),t._v(" "),e("td",[t._v("List<String>")]),t._v(" "),e("td",[e("code",[t._v('Lorem,ipsum,"doler sit amet"')])])]),t._v(" "),e("tr",[e("td",[t._v("IntegerListParameter")]),t._v(" "),e("td",[t._v("List<Int32>")]),t._v(" "),e("td",[e("code",[t._v("10,-1,0")])])]),t._v(" "),e("tr",[e("td",[t._v("DecimalListParameter")]),t._v(" "),e("td",[t._v("List<Single>")]),t._v(" "),e("td",[e("code",[t._v("0.2,10.5,-88.99")])])]),t._v(" "),e("tr",[e("td",[t._v("BooleanListParameter")]),t._v(" "),e("td",[t._v("List<Boolean>")]),t._v(" "),e("td",[e("code",[t._v("true,false,true")])])]),t._v(" "),e("tr",[e("td",[t._v("NamedStringListParameter")]),t._v(" "),e("td",[t._v("List<NamedString>")]),t._v(" "),e("td",[e("code",[t._v("Felix.Happy,Jenna.Confidence")])])]),t._v(" "),e("tr",[e("td",[t._v("NamedIntegerListParameter")]),t._v(" "),e("td",[t._v("List<NamedInteger>")]),t._v(" "),e("td",[e("code",[t._v("Yuko.5,Misaki.-8")])])]),t._v(" "),e("tr",[e("td",[t._v("NamedDecimalListParameter")]),t._v(" "),e("td",[t._v("List<NamedFloat>")]),t._v(" "),e("td",[e("code",[t._v("Nanikun.88.99,Yuko.-5.1")])])]),t._v(" "),e("tr",[e("td",[t._v("NamedBooleanListParameter")]),t._v(" "),e("td",[t._v("List<NamedBoolean>")]),t._v(" "),e("td",[e("code",[t._v("Misaki.false,Kohaku.true")])])])])]),t._v(" "),e("p",[t._v("任意でフィールドに "),e("code",[t._v("[ParameterAlias]")]),t._v(" 属性を適用して、パラメーターにエイリアス名を割り当て、naninovelスクリプトでパラメーターを参照するときにフィールド名の代わりに使用することができます。 パラメータを無名にしたい場合は、エイリアスとして "),e("code",[t._v("Command.NamelessParameterAlias")]),t._v(" 定数（空の文字列）を設定します。コマンドごとに設定できる無名パラメーターは1つだけです。")]),t._v(" "),e("p",[t._v("パラメーターを必須にするには（naninovelスクリプトで指定されていないときにエラーがログに記録されるようにするため）、フィールドに "),e("code",[t._v("[RequiredParameter]")]),t._v(" 属性を適用します。属性が適用されていない場合、パラメーターはオプションと見なされます。")]),t._v(" "),e("p",[t._v("すべてのパラメータータイプには "),e("code",[t._v("HasValue")]),t._v(" プロパティがあり、これを使用して、naninovelスクリプトでパラメーターが割り当てられているかどうかをテストできます。任意で "),e("code",[t._v("Command.Assigned()")]),t._v(" 静的メソッドを使用できます。これはパラメーターインスタンスを取得し、指定されたパラメーターが null ではなく、値が割り当てられている場合に true を返します。")]),t._v(" "),e("p",[t._v("コマンドの実行にリソースのロードが必要な場合は、"),e("code",[t._v("Command.IPreloadable")]),t._v(" インターフェースを実装して、ゲームのロード時に必要なリソースを事前ロードします。")]),t._v(" "),e("p",[t._v("コマンドにローカライズが必要なパラメーターがある場合（ユーザーに直接表示されるテキスト）、  "),e("code",[t._v("Command.ILocalizable")]),t._v(" インターフェイスを実装して、生成されたスクリプトローカリゼーションドキュメントにコマンドを追加します。")]),t._v(" "),e("p",[t._v("すべての組み込みコマンド実装を含むスクリプトは、"),e("code",[t._v("Naninovel/Runtime/Commands")]),t._v(" パッケージフォルダーにあります。独自のカスタムコマンドを実装するときは、参考にしてください。")]),t._v(" "),e("p",[t._v("以下はカスタムコマンドの例です。naninovelスクリプトから "),e("code",[t._v("@HelloWorld")]),t._v(" または "),e("code",[t._v("@hello")]),t._v(" で呼び出し、"),e("code",[t._v("Hello World!")]),t._v(" をコンソールに出力できます。また、worldの代わりにオプションの "),e("code",[t._v("name")]),t._v(" パラメータ（例: "),e("code",[t._v("@hello name:Felix")]),t._v("）を受け取って挨拶することもできます。")]),t._v(" "),e("div",{staticClass:"language-csharp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-csharp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("Naninovel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Commands")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("System"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Threading")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("UniRx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Async")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("UnityEngine")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token attribute"}},[e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CommandAlias")]),e("span",{pre:!0,attrs:{class:"token attribute-arguments"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HelloWorld")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token type-list"}},[e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Command")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StringParameter")]),t._v(" Name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("override")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("UniTask")]),t._v(" ExecuteAsync "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CancellationToken")]),t._v(" cancellationToken "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Assigned")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            Debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token interpolation-string"}},[e("span",{pre:!0,attrs:{class:"token string"}},[t._v('$"Hello, ')]),e("span",{pre:!0,attrs:{class:"token interpolation"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token expression language-csharp"}},[t._v("Name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('!"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            Debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello World!"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" UniTask"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CompletedTask"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("オプションの "),e("code",[t._v("CancellationToken")]),t._v(" 引数に注意してください。非同期メソッドを呼び出す場合は、キャンセルリクエストのトークンを確認して、できるだけ早く返してください。")]),t._v(" "),e("div",{staticClass:"custom-block example"},[e("p",{staticClass:"custom-block-title"},[t._v("例")]),t._v(" "),e("p",[t._v("別の例として、インベントリシステムにアイテムを追加/削除するカスタムコマンドは "),e("a",{attrs:{href:"https://github.com/Elringus/NaninovelInventory",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHubのインベントリサンプルプロジェクト"),e("OutboundLink")],1),t._v(" で見ることができます。")]),t._v(" "),e("p",[t._v("具体的には、コマンドの実装は "),e("a",{attrs:{href:"https://github.com/Elringus/NaninovelInventory/tree/master/Assets/NaninovelInventory/Runtime/Commands",target:"_blank",rel:"noopener noreferrer"}},[t._v("Runtime/Commands"),e("OutboundLink")],1),t._v(" ディレクトリに保存されています。")])])])}),[],!1,null,null,null);a.default=s.exports}}]);